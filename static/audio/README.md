# 拼图大师 - 背景音乐指南

本指南将帮助您为拼图大师游戏添加和管理背景音乐。

## 背景音乐文件要求

您需要准备以下4个MP3格式的音乐文件：

1. **main_theme.mp3** - 主界面背景音乐
   - 适用于：首页、选择关卡、我的拼图、排行榜、分享中心、拼图编辑器等页面
   - 建议风格：轻松愉快、节奏适中的背景音乐

2. **game_theme.mp3** - 游戏界面背景音乐
   - 适用于：拼图游戏进行时
   - 建议风格：稍微紧张但不影响思考的背景音乐，节奏可以稍快

3. **ai_theme.mp3** - AI生成界面背景音乐
   - 适用于：AI图片生成页面
   - 建议风格：神秘、科技感或创意感的背景音乐

4. **versus_theme.mp3** - 对战界面背景音乐
   - 适用于：房间对战页面
   - 建议风格：节奏较快、有竞争感的背景音乐

## 如何添加音乐文件

1. 将准备好的4个MP3文件重命名为上述指定的文件名
2. 将这些文件复制到 `static/audio/` 文件夹中
3. 刷新游戏页面，背景音乐功能将自动生效

## 音乐功能说明

### 音乐控制
- 游戏导航栏右侧添加了音乐控制按钮（扬声器图标）
- 点击按钮可以切换静音/取消静音状态
- 音乐设置会保存在浏览器本地存储中，下次打开游戏时保持上次设置

### 浏览器自动播放政策
由于浏览器的自动播放政策限制，背景音乐需要用户交互后才能播放：
- 用户首次打开页面后，需要点击页面或按下任意键才能播放音乐
- 一旦用户与页面交互，所有页面的背景音乐将正常工作

## 技术实现细节

### 音乐管理系统
- 游戏使用 `MusicManager` 类统一管理所有背景音乐
- 不同场景（页面）会自动切换到对应的背景音乐
- 音乐系统支持音量控制、静音切换和场景切换

### 文件结构
- `static/js/music.js` - 音乐管理器核心代码
- `static/audio/` - 存储背景音乐文件的文件夹
- 所有HTML页面都已集成背景音乐初始化代码

## 性能和兼容性建议

1. **文件大小优化**
   - 建议每个音乐文件大小控制在5MB以内
   - 可以使用音频压缩工具优化文件大小（如Audacity）

2. **格式兼容性**
   - 使用标准MP3格式（MPEG-1 Audio Layer III）
   - 采样率建议：44.1kHz 或 48kHz
   - 比特率建议：128kbps 至 320kbps

3. **版权注意事项**
   - 请确保使用的音乐文件拥有合法版权或在免费许可范围内
   - 推荐使用Creative Commons许可的音乐或无版权音乐

## 测试工具

我们提供了一个简单的音频测试页面，帮助您验证音乐文件是否能在浏览器中正常播放：

- 打开 `static/audio/test_audio.html` 页面
- 上传您的音乐文件进行测试
- 确保文件能正常播放且音质符合您的期望

## 常见问题解决

1. **音乐不播放**
   - 确认是否已正确放置音乐文件并命名
   - 确认是否已与页面进行交互（点击或按键）
   - 检查浏览器音量和静音设置
   - 尝试使用测试工具验证音频文件格式

2. **音乐切换不流畅**
   - 可能是因为音乐文件过大，加载时间较长
   - 尝试优化音频文件大小或使用更快的网络

3. **音质问题**
   - 检查音频文件本身的音质
   - 尝试使用更高比特率的音频文件

## 如何修改音乐逻辑

如果您需要自定义音乐播放逻辑，可以修改以下文件：
- `static/js/music.js` - 修改音乐管理器的核心逻辑
- `templates/_navbar.html` - 修改音乐控制按钮的样式和行为

---

祝您游戏开发愉快！如果您有任何问题或建议，请随时提出。